---
# - name: Clone jlrickert.me
#   git:
#     repo: "https://github.com/jlrickert/jlrickert.me.git"
#     dest: /usr/local/share/jlrickert.me
#     update: yes
#   become: yes
#   notify:
#     - restart nginx
# tags:
#   - jlrickert.me

- name: Create jlrickert.me deploy directory
  file:
    path: /usr/local/share/jlrickert.me
    state: directory
  tags:
    - jlrickert.me

- name: Create jlrickert.me log directory
  file:
    path: "{{ nginx.log }}/jlrickert.me"
    state: directory
  tags:
    - jlrickert.me

- name: Push jlrickert.me to nginx config
  template:
    src: jlrickert.me.j2
    dest: /etc/nginx/sites-available/jlrickert.me
  notify:
    - restart nginx
  tags:
    - jlrickert.me

- name: Enable jlrickert.me reverse proxy
  file:
    src: /etc/nginx/sites-available/jlrickert.me
    dest: /etc/nginx/sites-enabled/jlrickert.me
    state: link
  notify:
    - restart nginx
  tags:
    - jlrickert.me
