# {{ ansible_managed }}

user nginx http;
worker_processes auto;
events {
    worker_connections 1024;
}

http {
    include mime.types;
    default_type application/octet-stream;
    gzip on;

    include default.d/ssl.conf;

    # ssl_certificate ssl/jlrickert_bundle.crt;
    # ssl_certificate_key ssl/jlrickert.key;

    # Google DNS Servers
    resolver 8.8.8.8 8.8.4.4 valid=300s;
    resolver_timeout 5s;

    log_format main '$remote_addr - $remote_user [$time_local] "$request" ' '$status $body_bytes_sent "$http_referer" ' '"$http_user_agent" "$http_x_forwarded_for"';

    access_log {{ nginx.access_log }} main;
    sendfile on;
    tcp_nopush on;
    keepalive_timeout 65;

    proxy_cache_path {{ nginx.cache }} levels=1:2 keys_zone=STATIC:10m inactive=24h max_size=1g;

    include sites-enabled/*;
}
